<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>Pentest-env by Sliim</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Pentest-env</h1>
        <h2>Pentest environment (kali linux) deployer using vagrant and chef.</h2>

        <section id="downloads">
          <a href="https://github.com/Sliim/pentest-env/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/Sliim/pentest-env/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/Sliim/pentest-env" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a id="pentest-environment-deployment" class="anchor" href="#pentest-environment-deployment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pentest Environment Deployment</h1>

<p>This tool provide an easy way to deploy a clean pentesting environment with Kali linux using vagrant and virtualbox.</p>

<h2>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h2>

<p>I assume you are familiar with virtualbox and vagrant.</p>

<ul>
<li><a href="https://www.virtualbox.org/">https://www.virtualbox.org/</a></li>
<li><a href="http://www.vagrantup.com/">http://www.vagrantup.com/</a></li>
</ul>

<p>Tested with:</p>

<ul>
<li>Virtualbox (4.3.20)</li>
<li>Vagrant (1.7.1)</li>
</ul>

<h2>
<a id="about-boxes" class="anchor" href="#about-boxes" aria-hidden="true"><span class="octicon octicon-link"></span></a>About boxes</h2>

<h3>
<a id="boxes-url" class="anchor" href="#boxes-url" aria-hidden="true"><span class="octicon octicon-link"></span></a>Boxes URL</h3>

<ul>
<li>Kali linux 1.0: <a href="http://ftp.sliim-projects.eu/boxes/kali-linux-1.0-amd64.box">http://ftp.sliim-projects.eu/boxes/kali-linux-1.0-amd64.box</a>

<ul>
<li>VirtualBox 4.2.10</li>
<li>Vagrant 1.0.7</li>
</ul>
</li>
<li>Kali linux 1.0.4: <a href="http://ftp.sliim-projects.eu/boxes/kali-linux-1.0.4-amd64.box">http://ftp.sliim-projects.eu/boxes/kali-linux-1.0.4-amd64.box</a>

<ul>
<li>VirtualBox 4.2.16</li>
<li>Vagrant 1.2.7</li>
</ul>
</li>
</ul>

<h3>
<a id="changes-details" class="anchor" href="#changes-details" aria-hidden="true"><span class="octicon octicon-link"></span></a>Changes details</h3>

<p>Provided boxes are fresh install of Kali linux with some changes:</p>

<h4>
<a id="kali-linux-10" class="anchor" href="#kali-linux-10" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kali linux 1.0</h4>

<ul>
<li>Installation of linux kernel headers for vbox guest additions.</li>
<li>Installation of virtualbox guest additions.</li>
<li>Installation of <code>chef</code> package for provisioning.</li>
<li>
<code>vagrant</code> user was created for provisionning (Password: <code>tnargav</code>).</li>
<li>
<code>admin</code> group don't require password for sudo.</li>
<li>
<code>vagrant</code> user is in <code>admin</code> group.</li>
<li>Authorized keys for <code>vagrant</code> user are stored in <code>ssh-keys/</code> directory (no passphrase).</li>
<li>Enabling rpcbind, nfs-common and ssh services at boot.</li>
</ul>

<h4>
<a id="kali-linux-104" class="anchor" href="#kali-linux-104" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kali linux 1.0.4</h4>

<p>Fresh install from <a href="http://cdimage.kali.org/kali-latest/amd64/kali-linux-1.0.4-amd64-mini.iso">http://cdimage.kali.org/kali-latest/amd64/kali-linux-1.0.4-amd64-mini.iso</a></p>

<ul>
<li>Installation of linux kernel headers for vbox guest additions.</li>
<li>Installation of virtualbox guest additions.</li>
<li>Installation of <code>chef</code> package for provisioning.</li>
<li>Authorized keys for <code>root</code> user are stored in <code>ssh-keys/</code> directory (no passphrase).</li>
<li>Enabling rpcbind, nfs-common and ssh services at boot.</li>
<li>Modified /etc/issue for vagrant os detection.</li>
<li>MAC address for private network was added in /etc/NetworkManager/NetworkManager.conf to disable auto connect.</li>
</ul>

<p><strong>Please don't forget to read security warning below !</strong></p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>You will need rake and berkshelf for vm provisionning, you can install it with rubygems:</p>

<pre><code>gem install rake berkshelf
</code></pre>

<p>Clone pentest-env repository:</p>

<pre><code>git clone https://github.com/Sliim/pentest-env.git
</code></pre>

<p>Install cookbooks dependencies:</p>

<pre><code>rake
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="running-kali-linux" class="anchor" href="#running-kali-linux" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running Kali linux</h3>

<p>Pentest-env works with Vagrant, so all you need to know is to use basic vagrant features :)
To run kali instance:</p>

<pre><code>vagrant up kali
</code></pre>

<h3>
<a id="pentest-env-customizations" class="anchor" href="#pentest-env-customizations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pentest-env customizations</h3>

<p>Since Pentest-env 0.5.0, customizations are stored in <code>$HOME/.pentestrc</code> file as YAML format.
An example of configuration file is available at the root of this repository named <code>pentestrc.example</code></p>

<p>You can copy and edit it for your needs:</p>

<pre><code>cp pentestrc.example ~/.pentestrc
</code></pre>

<p>Here is a minimal configuration:</p>

<pre><code>scripts_path: ~/.pentest.d/scripts
targets_path: ~/.pentest.d/targets
targets: []
</code></pre>

<p>This setup set your <code>scripts</code> and <code>targets</code> directories used by pentest-env.
It also set an empty target list.. if you just want to run a Kali instance..</p>

<h4>
<a id="kali-linux-customizations" class="anchor" href="#kali-linux-customizations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kali linux customizations</h4>

<p>You can perform many customizations on kali linux instance.
Just add <code>kali</code> key in your <code>$HOME/.pentestrc</code>, below the availables customizations:</p>

<ul>
<li>
<code>packages</code> - An array of apt packages to install</li>
<li>
<code>commands</code> - List of command to run as inline shell script</li>
<li>
<code>scripts</code> - List of scripts to execute. They must be located in <code>scripts_path</code> directory</li>
<li>
<code>synced_folders</code> - Hash for forlders to sync with the instance</li>
</ul>

<p>Example:</p>

<pre><code>kali:
  packages: [git-core]
  commands:
  - curl https://opscode-omnibus-packages.s3.amazonaws.com/debian/6/x86_64/chef_12.0.3-1_amd64.deb -o chef.deb &amp;&amp; sudo dpkg -i chef.deb
  scripts: [openvas.sh]
  synced_folders: {data: /pentest}
</code></pre>

<h4>
<a id="targets-customization" class="anchor" href="#targets-customization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Targets customization</h4>

<p>You can easily deploy targets with your kali instance.
Pentest-env comes with some targets ready to use:</p>

<ul>
<li>
<code>dvwa</code> - DVWA (Damn Vulnerable Web Application) - <a href="http://www.dvwa.co.uk/">http://www.dvwa.co.uk/</a>
</li>
<li>
<code>vicnum</code> - OWASP Vicnum - <a href="https://www.owasp.org/index.php/Category:OWASP_Vicnum_Project">https://www.owasp.org/index.php/Category:OWASP_Vicnum_Project</a>
</li>
<li>
<code>gruyere</code> - Google Gruyere - <a href="http://google-gruyere.appspot.com/">http://google-gruyere.appspot.com/</a>
</li>
<li>
<code>bricks</code> - OWASP Bricks - <a href="https://www.owasp.org/index.php/OWASP_Bricks">https://www.owasp.org/index.php/OWASP_Bricks</a>
</li>
<li>
<code>webgoat</code> - OWASP WebGoat - <a href="https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project">https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project</a>
</li>
</ul>

<p>To setup targets to deploy, edit your <code>$HOME/.pentestrc</code> and set the <code>targets</code> list:</p>

<pre><code>targets: [dvwa vicnum]
</code></pre>

<p>You can add your own targets in your <code>targets_path</code> directory and use them in your <code>targets</code> list.</p>

<p>Targets instance can be customized same as the kali instance, use the target's name as a key in your configuration file to customize the targets:</p>

<pre><code>dvwa:
  packages: [git-core]
vicnum:
  packages: [git-core]
</code></pre>

<h2>
<a id="known-issues" class="anchor" href="#known-issues" aria-hidden="true"><span class="octicon octicon-link"></span></a>Known issues</h2>

<h3>
<a id="hostonly-on-kali-linux-10-fail" class="anchor" href="#hostonly-on-kali-linux-10-fail" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hostonly on kali linux 1.0 fail</h3>

<p>Hostonly connection will be reset at first vm creation.
To resolve this, disconnect connection in gui mode and run in your vagrant directory:</p>

<pre><code>vagrant reload kali
</code></pre>

<h2>
<a id="security-warning" class="anchor" href="#security-warning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Security warning</h2>

<h3>
<a id="kali-linux-10-1" class="anchor" href="#kali-linux-10-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kali linux 1.0</h3>

<p>Virtual machine boot with sshd service running and may cause some security issues:</p>

<ul>
<li>Bridged network is enabled by default.</li>
<li>Default root password of this box is insecure (toor).</li>
<li>Vagrant user is insecure

<ul>
<li>Private key stored in <code>ssh-keys/</code>.</li>
<li>Password known (<code>tnargav</code>).</li>
<li>User in sudoers with no password required.</li>
</ul>
</li>
</ul>

<h3>
<a id="kali-linux-104-1" class="anchor" href="#kali-linux-104-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kali linux 1.0.4</h3>

<p>Virtual machine boot with sshd service running and may cause some security issues:</p>

<ul>
<li>Bridged network is enabled by default.</li>
<li>Default root password of this box is insecure (toor).</li>
</ul>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>See COPYING file</p>
      </section>
    </div>

    
  </body>
</html>