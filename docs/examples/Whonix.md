# Configure Kali linux with Whonix gateway

## Sources
- https://github.com/Sliim/pentest-env/issues/19
- https://scottlinux.com/2015/09/01/use-kali-linux-through-tor-with-whonix-gateway/

## Pentestrc
This `pentestrc` will create and provision the `kali` instance with the Whonix Gateway (note: the whonix gateway must be started manually, it's address should be `10.152.152.10`):
```
instances:
  - kali

kali:
  networks:
    - private_network:
        adapter: 2
        virtualbox__intnet: Whonix
        auto_config: false
  chef:
    recipes:
      - pentestenv::whonix
      - resolver
    json:
      pentestenv:
        whonix:
          interface: eth1
          gateway: 10.152.152.10
          address: 10.152.152.11
          netmask: 255.255.192.0
      resolver:
        nameservers:
          - 10.152.152.10
```

You can find this configuration file in [examples/whonix.pentestrc](../../examples/whonix.pentestrc).

Use it and run kali instance:
```
PENTESTRC=examples/whonix.pentestrc vagrant up kali
```

Once the virtual machine is created and provisioned, you can check you are routed to the Whonix gateway by [checking Tor status](https://check.torproject.org).
